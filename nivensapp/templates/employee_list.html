{% extends 'header.html' %}
{% load static %}

{% block main %}

<link rel="stylesheet" type="text/css" href="{% static 'DataTables/datatables.min.css' %}">
<script type="text/javascript" src="{% static 'DataTables/datatables.min.js' %}"></script>
<link rel="stylesheet" type="text/css" href="{% static 'jquery/jquery.floatingscroll.css' %}">
<script type="text/javascript" src="{% static 'jquery/jquery.floatingscroll.min.js' %}"></script>

<style>

    h1 {
        text-align:center;
        color: #696969;
    }

    .btn-success {
        margin-top: 28px;
        float: right;
    }

    .thead {
        background-color: #D3D3D3;

    }

</style>

<br>
<h1>Nivens</h1>
<hr>
<br>
<div class="row">
    <div class="col-sm-3">
        <label class="control-label"><b>Departamento</b></label>
        <select class="selectpicker form-control" name="department" id="department" data-live-search="True">
            <option value="">Todos</option>
            {% for d in department %}
                <option value="{{ d.id }}">{{ d }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="col-sm-9">
        <a href="">
            <button class="btn btn-success" id="" type="button">Cadastrar Funcionário</button>
        </a>
    </div>
</div>
<br><br><br>
<div class="row">
    <div class="col-sm-12 col-lg-12 col-md-12 col-xs-12">
        <div class="scrollbar-table" id="table">
            <table class="table table-bordered" id="data_table" style="padding: inherit;">
                <thead class="thead">
                    <tr>
                        <th scope="col" style="width: 250px;">Nome</th>
                        <th scope="col" style="width: 250px;">E-mail</th>
                        <th scope="col">Departamento</th>
                        <th scope="col">Situação</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
</div>
<br>
<br>


<script>
    var data = [];
    generateTable();
    function generateTable(){
        data = {'department': $('#department').val()};
        console.log(data);
        datatable_ticket = $('#data_table').DataTable({
                "destroy": true,
                "fixedHeader": false,
                "ordering": false,
                "processing": true,
                "serverSide": true,
                "ajax":{
                        url: "/api/list_employee/",
                        type: "GET",
                        data: data,
                        complete: function(response){
                            $(".scrollbar-table").floatingScroll();
                        }
                },
                "iDisplayLength": 50,
                "bJQueryUI": false,
                "language": {
                    "lengthMenu": "Mostrando _MENU_ registros por página.",
                    "zeroRecords": "Não foram encontrados registros",
                    "info": "Exibindo _START_ até _END_ de um total de _TOTAL_ produtos",
                    "infoEmpty": "Não foram encontrados registros",
                    "infoFiltered": "(filtrados de um total de _MAX_ funcionários)",
                    "paginate": {
                        "first": "Primeiro",
                        "last": "Último",
                        "next": "Próximo",
                        "previous": "Anterior"
                    },
                    "search": "Buscar:"
                }

        });
    }

    $('#department').change(function(){
        generateTable();
    });

</script>

{% endblock %}

